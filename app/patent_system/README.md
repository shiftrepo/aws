# 特許出願人分析MCPサーバー

特許審査官向けに開発された、特許出願人の詳細な分析を行うためのModel Context Protocol (MCP) サーバーです。このシステムは、LLM（Large Language Model、大規模言語モデル）に特許出願人に関する様々な分析機能を提供し、査定比率や技術分野の分布などの洞察を提供します。

## 概要

このMCPサーバーは、特許審査官が特許出願人に関する詳細な情報を取得し、効率的な審査業務を支援するために設計されています。ChatGPTやClaudeなどのAIアシスタントを通じて、以下のような情報を簡単に取得できます：

- 出願人の特許査定率と拒絶率
- 技術分野ごとの出願分布
- 競合他社との比較分析
- 審査官向けの洞察と推奨事項
- 視覚的なデータ（グラフやチャート）を含むレポート

## 機能

### 主要ツール

1. **get_applicant_summary**
   - 出願人の総合的な概要を取得（査定統計、出願履歴、技術分布、審査官向け洞察等）
   - 例：「テック株式会社の出願状況の概要を教えてください」

2. **generate_visual_report**
   - チャートや図表を含む視覚的なレポートを生成
   - Markdownフォーマットでの出力（データの視覚化を含む）
   - 例：「AIソリューションズの特許審査レポートを図表付きで作成してください」

3. **analyze_assessment_ratios**
   - 出願人の査定比率（特許査定、拒絶査定等）を分析
   - 円グラフによる視覚化
   - 例：「データシステムズの特許査定率と拒絶率を分析してください」

4. **analyze_technical_fields**
   - 出願人の技術分野別分布を分析
   - 横棒グラフによる視覚化
   - 技術ドメイン分析（AIやIoT等の高レベルカテゴリ）
   - 例：「未来技研の技術分野別出願分布を教えてください」

5. **compare_with_competitors**
   - 出願人と競合他社の比較分析
   - 査定率の比較グラフ
   - 技術分野別の比較グラフ
   - 例：「イノベーション製造と主要競合他社の特許状況を比較してください」

### リソース

1. **current_date**
   - 特許分析における参照用の現在日付
   - 例：「2025-04-20」のような形式で日付情報を提供

2. **patent_status_descriptions**
   - 特許状態（特許査定、拒絶査定、審査中等）の説明
   - 各状態の意味を日本語で解説
   - 例：「特許状態の各種ステータスの意味を教えてください」

3. **ipc_code_reference**
   - 国際特許分類（IPC）コードのリファレンス
   - IPCコードと対応する技術分野の日本語説明
   - 例：「G06Fは何を意味するIPCコードですか？」

4. **top_applicants**
   - データベース内の主要出願人のリスト
   - 出願人名とその特許出願数を含む
   - 例：「データベース内の主要出願人を出願数の多い順に教えてください」

## アーキテクチャ

このシステムは以下のコンポーネントで構成されています：

1. **ApplicantAnalyzer** - 出願人分析の中核ロジックを提供するクラス
   - 査定統計の生成
   - 技術分野分布の分析
   - 視覚化チャートの生成
   - 競合比較分析

2. **PatentApplicantServer** - MCPサーバーとして機能するクラス
   - ツールとリソースの定義
   - AIアシスタントからのリクエスト処理
   - 分析結果のフォーマット

3. **MCP設定** - MCPプロトコルとの統合を設定

## ファイル構成

- **applicant_analyzer.py** - 特許出願人分析のコア機能を提供
- **mcp_patent_server.py** - MCPサーバーの実装
- **mcp_config.json** - MCPサーバーの設定ファイル
- **mcp_demo.py** - 使用方法のデモスクリプト
  - 各ツールとリソースの使用例を示す
  - 異なるデータ形式（リスト、辞書など）の処理方法もデモ
- **README.md** - 本ドキュメント

## 使用方法

### MCPサーバーの起動

通常、このMCPサーバーはMCPプロトコルをサポートするAIアシスタント（Claude等）の環境で自動的に起動されます。デモ目的の場合は以下のように起動できます：

```bash
# プロジェクトのルートディレクトリから実行
python -m app.patent_system.mcp_demo
```

### AIアシスタントを通じたMCPツールの使用例

AIアシスタントを使用して以下のように質問すると、MCPツールが自動的に呼び出されます：

1. **基本的な出願人情報の取得**
   ```
   テック株式会社の特許出願状況を教えてください。査定率と主な技術分野も含めてください。
   ```

2. **視覚的な分析レポートの生成**
   ```
   AIソリューションズの特許審査レポートを作成してください。査定率と技術分野の分布に関するグラフを含めてください。
   ```

3. **競合他社との比較**
   ```
   データシステムズと主要競合他社の特許査定率を比較し、技術分野ごとの違いを分析してください。
   ```

4. **特定技術分野の詳細分析**
   ```
   未来技研のAI関連技術（G06N）の特許出願について、詳細な分析をしてください。
   ```

5. **審査業務支援**
   ```
   イノベーション製造の拒絶される傾向がある特許出願について、パターンを分析してください。
   ```

### デモ機能

`mcp_demo.py`スクリプトは以下の機能をデモしています：

- 利用可能なツールとリソースの一覧表示
- 出願人の概要情報取得
- 視覚的なレポート生成
- 査定率分析
- 技術分野分析
- 競合比較
- リソースアクセス（各種リファレンス情報の取得）

#### リソース形式の注意点

- **top_applicants** - リスト形式で返されます（各要素は出願人情報を含む辞書）
- その他のリソースは主に辞書形式で返されます
- `mcp_demo.py`では両方の形式に対応するよう実装されています

## 特許審査官向け利用シナリオ

### シナリオ1: 新規出願の審査前の出願人調査

特許審査官が新しい出願を審査する前に、出願人の過去の出願パターン、査定率、よく使用される技術分野などを把握するために使用します。

```
テック株式会社の過去の特許出願傾向と査定率を教えてください。特に、G06F分野についての詳細も知りたいです。
```

### シナリオ2: 審査の優先順位付け

多数の出願を抱える審査官が、出願人の過去の出願履歴や査定率に基づいて、審査の優先順位を決定するために使用します。

```
現在審査中の出願のうち、過去の査定率が高い企業のリストを作成し、その技術分野ごとの出願数もまとめてください。
```

### シナリオ3: 拒絶理由通知の準備

審査官が拒絶理由通知を作成する際に、過去の同様の出願における拒絶理由のパターンを参照するために使用します。

```
AIソリューションズの過去の拒絶された出願について、拒絶理由のパターンを分析し、現在審査中のG06N分野の出願にどのように適用できるか示してください。
```

### シナリオ4: 技術動向の把握

審査官が特定の技術分野における出願トレンドを把握し、審査の文脈を理解するために使用します。

```
過去5年間のG06N分類における主要出願人とその査定率の推移を分析してください。技術のサブカテゴリごとの傾向も示してください。
```

### シナリオ5: 審査レポートの作成

審査結果をまとめる際に、視覚的なデータを含む包括的なレポートを生成するために使用します。

```
データシステムズの特許ポートフォリオ分析レポートを作成してください。査定率、技術分野の分布、競合他社との比較を含む視覚的なグラフを追加してください。
```

## 初めての利用者向けガイド

### 基本的な使い方

1. **質問の仕方**: 特許出願人の名前を明確に述べ、知りたい情報の種類を指定してください
   ```
   「テック株式会社の特許出願状況について教えてください」
   ```

2. **特定の情報を求める場合**: より具体的な質問をすることで、必要な情報を効率的に取得できます
   ```
   「テック株式会社の過去3年間の特許査定率と主要技術分野を教えてください」
   ```

3. **視覚的なデータが欲しい場合**: レポートや視覚化を求める旨を明記してください
   ```
   「テック株式会社の技術分野別出願状況をグラフで表示してください」
   ```

4. **比較分析が必要な場合**: 比較したい対象企業を明確に伝えてください
   ```
   「テック株式会社とイノベーション製造の特許出願状況を比較してください」
   ```

### 技術用語集

* **特許査定率**: 審査の結果、特許として認められた出願の割合
* **拒絶率**: 審査の結果、特許として認められなかった出願の割合
* **IPC分類**: 国際特許分類。技術分野を体系的に分類するコード
  * 例: G06F（電気的デジタルデータ処理）
* **審査中（pending）**: 現在審査プロセス中の出願
* **取下げ（withdrawn）**: 出願人によって取り下げられた出願
* **審判請求（appealed）**: 拒絶査定に対して審判請求されている出願

## 必要条件

- Python 3.8以上
- matplotlib（グラフ作成用）
- numpy（データ処理用）
- pandas（データ分析用）

## MCP統合

このシステムはModel Context Protocol (MCP)に準拠しており、以下の方法でAIアシスタントと統合できます：

1. `mcp_config.json`ファイルをMCP設定ディレクトリに配置
2. AIサービスを再起動して新しいMCPサーバーを読み込み
3. AIアシスタントを通じてツールとリソースにアクセス

## トラブルシューティング

### 一般的な問題と解決策

1. **リソースが正しく表示されない場合**
   * 異なるデータ形式（リストや辞書）が適切に処理されているか確認
   * `mcp_demo.py`のデモ機能を使って動作を確認

2. **視覚的なデータが表示されない場合**
   * フォント設定と日本語文字の表示設定を確認
   * matplotlibの日本語フォント設定が正しいか確認

3. **特定の出願人の情報が取得できない場合**
   * 出願人名の表記が正確か確認
   * データベース内に該当する出願人が存在するか確認

### 最近の修正・更新内容

* **2025-04-20**: `top_applicants`リソースの戻り値がリスト形式であることに対応するため、`mcp_demo.py`の`simulate_mcp_call`関数を修正しました。異なるデータ形式（リストと辞書）を適切に処理するためのチェックを追加しました。
