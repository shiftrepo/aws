# 特許出願動向分析ツール

このツールは、patentDWHシステムを利用して、特定の出願人（企業等）の特許出願動向を分析し、特許分類（IPC）別に時系列でグラフ化するとともに、LLMを利用して日本語で動向分析を行うツールです。

## 機能

1. 指定した出願人の特許出願データを特許分類（IPC）別・年別に集計
2. 時系列での特許出願動向を積み上げ棒グラフとして可視化
3. LLMを利用して特許出願動向を日本語で分析
4. 分析結果をMarkdownレポートとして出力

## 前提条件

- patentDWHサーバーが実行中であること
  - データベースサーバー: http://localhost:5002
  - MCPサーバー: http://localhost:8080
- Python 3.8以上がインストールされていること

## セットアップ

1. 必要なパッケージをインストール:

```bash
pip install -r requirements.txt
```

## 使用方法

```bash
python patent_trend_analyzer.py <出願人名> [データベースタイプ]
```

### パラメータ

- `<出願人名>`: 分析したい出願人の名称（必須）
- `[データベースタイプ]`: 使用するデータベース（オプション、デフォルトは「inpit」）
  - 選択肢: `inpit`, `google_patents_gcp`, `google_patents_s3`

### 使用例

```bash
# テック株式会社の特許出願動向を分析（INPITデータベース使用）
python patent_trend_analyzer.py テック株式会社

# Sonyの特許出願動向を分析（Google Patentsデータベース使用）
python patent_trend_analyzer.py Sony google_patents_gcp
```

## 出力ファイル

スクリプトは以下のファイルを生成します：

1. `[出願人名]_classification_trend.png` - 特許分類別の時系列グラフ
2. `[出願人名]_patent_analysis.md` - 分析レポート（Markdown形式）

## 注意事項

- 日本語の出願人名を入力する場合、ファイル名は自動的に英数字に変換されます
- グラフには2バイト文字（日本語など）は使用されません
- データベース接続に失敗した場合は、patentDWHサービスが正しく起動しているか確認してください

## 技術的な詳細

このツールは以下のプロセスで動作します：

1. 特許データベースからSQL経由で出願人の特許データを取得
2. 取得したデータを分類別・年別に集計
3. Matplotlibを使用して積み上げ棒グラフを生成
4. LLMを利用してデータの傾向分析を実行（AWS Bedrockを使用）
5. グラフと分析結果をMarkdownレポートとして出力

## トラブルシューティング

- **データが見つからない場合**: 出願人名の表記を変えて試してみてください
- **APIエラー**: patentDWHサーバーが起動しているか確認してください
- **グラフが生成されない**: 指定した出願人のデータが存在するか確認してください
- **LLM分析が失敗**: AWS認証情報が正しく設定されているか確認してください
