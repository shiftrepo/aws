# AWS認証情報の安全な使用方法

このドキュメントでは、patentDWHシステムでAWS認証情報を安全に使用する方法を説明します。

## セキュリティ上の重要事項

1. **AWS認証情報を決してコードやDockerfile内にハードコードしないでください**
2. **ログに認証情報が出力されないようにしてください**
3. **常に環境変数を使用してAWS認証情報を提供してください**

## 正しい使用方法

### 環境変数の設定

システムを実行する前に、ターミナルで以下のコマンドを実行して環境変数を設定します：

```bash
export AWS_ACCESS_KEY_ID="your_access_key_here"
export AWS_SECRET_ACCESS_KEY="your_secret_key_here"
export AWS_DEFAULT_REGION="us-east-1"  # または適切なリージョン
```

### 一時的な使用方法

一時的にのみ認証情報を使用する場合は、サービス起動時に直接指定することも可能です：

```bash
AWS_ACCESS_KEY_ID="your_access_key" AWS_SECRET_ACCESS_KEY="your_secret_key" ./start_all_services.sh
```


### AWS認証情報ファイルの使用

AWS CLIの認証情報ファイル（`~/.aws/credentials`）を使用することも可能です。この場合、コンテナ起動時にこのディレクトリをマウントするように設定します。

## セキュリティのベストプラクティス

1. **最小権限の原則を適用する**：使用するAWSユーザーには必要最小限のアクセス権限のみを付与してください
2. **一時的な認証情報を使用する**：可能な限り、IAMロールや一時的な認証情報を使用してください
3. **認証情報を定期的にローテーションする**：アクセスキーを定期的に更新してください
4. **環境変数の値を表示しない**：ログやデバッグ出力で認証情報の値を直接表示しないでください
5. **AWS KMSの使用を検討する**：重要な情報の暗号化にAWS Key Management Serviceの使用を検討してください

## 問題の修正

当システムで認証情報漏洩の問題が発見された場合は、以下の手順で修正してください：

1. 露出してしまったアクセスキーを即時に無効化・削除する
2. 新しいアクセスキーを発行する
3. すべてのコードとログから漏洩したアクセスキーを削除する
4. コードを修正して安全な認証情報の取り扱いを確保する
