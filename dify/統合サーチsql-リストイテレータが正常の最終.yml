app:
  description: ã‚¦ã‚§ãƒ–æ¤œç´¢ã‚’æ´»ç”¨ã—ã¦æœ€æ–°æƒ…å ±ã‚’å–å¾—ã—ã€è³ªå•ã«å›ç­”ã™ã‚‹ã‚¢ãƒ—ãƒªã®ä½œæˆæ–¹æ³•ã‚’è§£èª¬ã—ã¦ã„ã¾ã™ã€‚è¤‡æ•°ã®æ¤œç´¢ã‚¯ã‚¨ãƒªã‚’ä¸¦åˆ—å‡¦ç†ã§å®Ÿè¡Œã—ã€Tavily
    Searchã‚’ä½¿ã£ã¦é–¢é€£æƒ…å ±ã‚’åé›†ã€‚å¾—ã‚‰ã‚ŒãŸæƒ…å ±ã‚’åŸºã«LLMãŒæ–‡è„ˆã‚’è€ƒæ…®ã—ãŸå›ç­”ã‚’ç”Ÿæˆã—ã¾ã™ã€‚
  icon: ğŸ¤–
  icon_background: '#FFEAD5'
  mode: advanced-chat
  name: çµ±åˆã‚µãƒ¼ãƒsql
  use_icon_as_answer_icon: false
dependencies:
- current_identifier: null
  type: marketplace
  value:
    marketplace_plugin_unique_identifier: langgenius/bedrock:0.0.18@af12ae0bf52866c1a81405adaa6020137bc2657f129cc6628022f1245d7c88ff
- current_identifier: null
  type: marketplace
  value:
    marketplace_plugin_unique_identifier: langgenius/searxng:0.0.5@4d354290d66892676a9f9dc7ce75cef323aae25dfc1c5057c7f770bd1052441b
kind: app
version: 0.3.0
workflow:
  conversation_variables: []
  environment_variables: []
  features:
    file_upload:
      allowed_file_extensions:
      - .JPG
      - .JPEG
      - .PNG
      - .GIF
      - .WEBP
      - .SVG
      allowed_file_types:
      - image
      allowed_file_upload_methods:
      - local_file
      - remote_url
      enabled: false
      fileUploadConfig:
        audio_file_size_limit: 50
        batch_count_limit: 5
        file_size_limit: 15
        image_file_size_limit: 10
        video_file_size_limit: 100
        workflow_file_upload_limit: 10
      image:
        enabled: false
        number_limits: 3
        transfer_methods:
        - local_file
        - remote_url
      number_limits: 3
    opening_statement: ''
    retriever_resource:
      enabled: true
    sensitive_word_avoidance:
      enabled: false
    speech_to_text:
      enabled: false
    suggested_questions: []
    suggested_questions_after_answer:
      enabled: false
    text_to_speech:
      enabled: false
      language: ''
      voice: ''
  graph:
    edges:
    - data:
        isInIteration: true
        isInLoop: false
        iteration_id: '1747547366688'
        sourceType: iteration-start
        targetType: tool
      id: 1747547366688start-source-1747547417399-target
      selected: false
      source: 1747547366688start
      sourceHandle: source
      target: '1747547417399'
      targetHandle: target
      type: custom
      zIndex: 1002
    - data:
        isInIteration: true
        isInLoop: false
        iteration_id: '1747547366688'
        sourceType: tool
        targetType: code
      id: 1747547417399-source-1747547714864-target
      selected: false
      source: '1747547417399'
      sourceHandle: source
      target: '1747547714864'
      targetHandle: target
      type: custom
      zIndex: 1002
    - data:
        isInLoop: false
        sourceType: llm
        targetType: code
      id: 1747546119142-source-1733226408233-target
      selected: false
      source: '1747546119142'
      sourceHandle: source
      target: '1733226408233'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: start
        targetType: llm
      id: 1733192412182-source-1747546119142-target
      selected: false
      source: '1733192412182'
      sourceHandle: source
      target: '1747546119142'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: code
        targetType: iteration
      id: 1733226408233-source-1747547366688-target
      selected: false
      source: '1733226408233'
      sourceHandle: source
      target: '1747547366688'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: template-transform
        targetType: answer
      id: 1747559305533-source-1747559467203-target
      selected: false
      source: '1747559305533'
      sourceHandle: source
      target: '1747559467203'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: start
        targetType: llm
      id: 1733192412182-source-1747561605205-target
      selected: false
      source: '1733192412182'
      sourceHandle: source
      target: '1747561605205'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: llm
        targetType: code
      id: 1747561605205-source-1747563309793-target
      selected: false
      source: '1747561605205'
      sourceHandle: source
      target: '1747563309793'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: iteration
        targetType: llm
      id: 1747547366688-source-1747566414888-target
      selected: false
      source: '1747547366688'
      sourceHandle: source
      target: '1747566414888'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: llm
        targetType: code
      id: 1747566414888-source-1747558891643-target
      selected: false
      source: '1747566414888'
      sourceHandle: source
      target: '1747558891643'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: code
        targetType: template-transform
      id: 1747558891643-source-1747559305533-target
      selected: false
      source: '1747558891643'
      sourceHandle: source
      target: '1747559305533'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: code
        targetType: template-transform
      id: 1747564264364-source-1747568809800-target
      selected: false
      source: '1747564264364'
      sourceHandle: source
      target: '1747568809800'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: template-transform
        targetType: llm
      id: 1747568809800-source-1747566414888-target
      selected: false
      source: '1747568809800'
      sourceHandle: source
      target: '1747566414888'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: code
        targetType: http-request
      id: 1747563309793-source-1747658438705-target
      selected: false
      source: '1747563309793'
      sourceHandle: source
      target: '1747658438705'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: http-request
        targetType: llm
      id: 1747658438705-source-1747658612936-target
      selected: false
      source: '1747658438705'
      sourceHandle: source
      target: '1747658612936'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: llm
        targetType: llm
      id: 1747658612936-source-1747566414888-target
      selected: false
      source: '1747658612936'
      sourceHandle: source
      target: '1747566414888'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: code
        targetType: tool
      id: 1747563309793-source-1747825209620-target
      source: '1747563309793'
      sourceHandle: source
      target: '1747825209620'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: tool
        targetType: code
      id: 1747825209620-source-1747564264364-target
      source: '1747825209620'
      sourceHandle: source
      target: '1747564264364'
      targetHandle: target
      type: custom
      zIndex: 0
    nodes:
    - data:
        desc: ''
        selected: false
        title: è³ªå•ã®å…¥åŠ›
        type: start
        variables: []
      height: 54
      id: '1733192412182'
      position:
        x: 332.3745379813148
        y: 421.5
      positionAbsolute:
        x: 332.3745379813148
        y: 421.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "import json\n\ndef main(arg1: str) -> dict:\n    queries = json.loads(arg1)[\"\
          query\"]\n    return {\n        \"result\": queries,\n    }\n"
        code_language: python3
        desc: ''
        outputs:
          result:
            children: null
            type: array[string]
        selected: false
        title: WEBæ¤œç´¢æ–‡è¨€ãƒªã‚¹ãƒˆä½œæˆ
        type: code
        variables:
        - value_selector:
          - '1747546119142'
          - text
          variable: arg1
      height: 54
      id: '1733226408233'
      position:
        x: 942
        y: 421.5
      positionAbsolute:
        x: 942
        y: 421.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: ''
        memory:
          query_prompt_template: '{{#sys.query#}}'
          role_prefix:
            assistant: ''
            user: ''
          window:
            enabled: false
            size: 50
        model:
          completion_params:
            temperature: 0.2
          mode: chat
          name: anthropic claude
          provider: langgenius/bedrock/bedrock
        prompt_template:
        - id: 845e6ae7-c80f-45c9-9562-09c047ae7354
          role: system
          text: 'ã‚ãªãŸã®å½¹å‰²ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå…¥åŠ›ã—ãŸãƒ†ã‚­ã‚¹ãƒˆã¨éå»ã®ä¼šè©±å±¥æ­´ã‹ã‚‰ã€æœ€é©ãªæ¤œç´¢ã‚¯ã‚¨ãƒªã‚’3ã¤ç”Ÿæˆã™ã‚‹ã“ã¨ã§ã™ã€‚


            ### ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³

            - å…¥åŠ›ãƒ†ã‚­ã‚¹ãƒˆã¨éå»ã®ä¼šè©±ã®æ–‡è„ˆã‚’è€ƒæ…®ã—ã¦ã€é–¢é€£ã™ã‚‹æ¤œç´¢ã‚¯ã‚¨ãƒªã‚’ç”Ÿæˆã—ã¦ãã ã•ã„

            - æ›–æ˜§ãªè¡¨ç¾ï¼ˆã€Œã“ã‚Œã€ã€Œãã‚Œã€ãªã©ï¼‰ã¯å…·ä½“çš„ãªè¡¨ç¾ã«ç½®ãæ›ãˆã¦ãã ã•ã„

            - å…·ä½“çš„ã§æ¤œç´¢ã«é©ã—ãŸè¡¨ç¾ã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„

            - ç•°ãªã‚‹å´é¢ã‚„è¦–ç‚¹ã‹ã‚‰ã®æ¤œç´¢ã‚¯ã‚¨ãƒªã‚’ç”Ÿæˆã—ã¦ãã ã•ã„

            - å„ã‚¯ã‚¨ãƒªã¯30æ–‡å­—ä»¥å†…ã«åã‚ã¦ãã ã•ã„


            ### å‡ºåŠ›å½¢å¼

            JSONå½¢å¼ã§å‡ºåŠ›:

            {"query": [query_1, query_2, query_3]}'
        selected: false
        structured_output:
          schema:
            additionalProperties: false
            properties: {}
            required: []
            type: object
        structured_output_enabled: false
        title: LLMã«ã‚ˆã‚‹æƒ…å ±åé›†è¦–ç‚¹ä½œæˆ
        type: llm
        variables: []
        vision:
          enabled: false
      height: 90
      id: '1747546119142'
      position:
        x: 662.032388469495
        y: 421.5
      positionAbsolute:
        x: 662.032388469495
        y: 421.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ''
        error_handle_mode: terminated
        height: 243
        is_parallel: false
        iterator_selector:
        - '1733226408233'
        - result
        output_selector:
        - '1747547714864'
        - filtered_results
        output_type: array[object]
        parallel_nums: 10
        selected: false
        start_node_id: 1747547366688start
        title: ãƒªã‚¹ãƒˆã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
        type: iteration
        width: 738
      height: 243
      id: '1747547366688'
      position:
        x: 1232.985990891525
        y: 421.5
      positionAbsolute:
        x: 1232.985990891525
        y: 421.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 738
      zIndex: 1
    - data:
        desc: ''
        isInIteration: true
        selected: false
        title: ''
        type: iteration-start
      draggable: false
      height: 48
      id: 1747547366688start
      parentId: '1747547366688'
      position:
        x: 24
        y: 68
      positionAbsolute:
        x: 1256.985990891525
        y: 489.5
      selectable: false
      sourcePosition: right
      targetPosition: left
      type: custom-iteration-start
      width: 44
      zIndex: 1002
    - data:
        desc: ''
        isInIteration: true
        isInLoop: false
        is_team_authorization: true
        iteration_id: '1747547366688'
        output_schema: null
        paramSchemas:
        - auto_generate: null
          default: null
          form: llm
          human_description:
            en_US: Enter your search query
            ja_JP: Enter your search query
            pt_BR: Enter your search query
            zh_Hans: è¾“å…¥æœç´¢å…³é”®è¯
          label:
            en_US: Query string
            ja_JP: Query string
            pt_BR: Query string
            zh_Hans: æŸ¥è¯¢è¯­å¥
          llm_description: Key words for searching
          max: null
          min: null
          name: query
          options: []
          placeholder: null
          precision: null
          required: true
          scope: null
          template: null
          type: string
        - auto_generate: null
          default: general
          form: form
          human_description:
            en_US: Search the web using SearXNG, a privacy-respecting metasearch engine
            ja_JP: Search the web using SearXNG, a privacy-respecting metasearch engine
            pt_BR: Search the web using SearXNG, a privacy-respecting metasearch engine
            zh_Hans: ä½¿ç”¨æ³¨é‡éšç§çš„å…ƒæœç´¢å¼•æ“ SearXNG æœç´¢ç½‘é¡µ
          label:
            en_US: search type
            ja_JP: search type
            pt_BR: search type
            zh_Hans: æœç´¢ç±»å‹
          llm_description: ''
          max: null
          min: null
          name: search_type
          options:
          - label:
              en_US: General
              ja_JP: General
              pt_BR: General
              zh_Hans: ç»¼åˆ
            value: general
          - label:
              en_US: Images
              ja_JP: Images
              pt_BR: Images
              zh_Hans: å›¾ç‰‡
            value: images
          - label:
              en_US: Videos
              ja_JP: Videos
              pt_BR: Videos
              zh_Hans: è§†é¢‘
            value: videos
          - label:
              en_US: News
              ja_JP: News
              pt_BR: News
              zh_Hans: æ–°é—»
            value: news
          - label:
              en_US: Map
              ja_JP: Map
              pt_BR: Map
              zh_Hans: åœ°å›¾
            value: map
          - label:
              en_US: Music
              ja_JP: Music
              pt_BR: Music
              zh_Hans: éŸ³ä¹
            value: music
          - label:
              en_US: It
              ja_JP: It
              pt_BR: It
              zh_Hans: ä¿¡æ¯æŠ€æœ¯
            value: it
          - label:
              en_US: Science
              ja_JP: Science
              pt_BR: Science
              zh_Hans: ç§‘å­¦
            value: science
          - label:
              en_US: Files
              ja_JP: Files
              pt_BR: Files
              zh_Hans: æ–‡ä»¶
            value: files
          - label:
              en_US: Social Media
              ja_JP: Social Media
              pt_BR: Social Media
              zh_Hans: ç¤¾äº¤åª’ä½“
            value: social_media
          placeholder: null
          precision: null
          required: true
          scope: null
          template: null
          type: select
        - auto_generate: null
          default: null
          form: form
          human_description:
            en_US: corresponding to the SearXNG API's time_range parameter, also depends
              on whether the search engine supports it
            ja_JP: corresponding to the SearXNG API's time_range parameter, also depends
              on whether the search engine supports it
            pt_BR: corresponding to the SearXNG API's time_range parameter, also depends
              on whether the search engine supports it
            zh_Hans: å¯¹åº”çš„æ˜¯ SearXNG API çš„ time_range å‚æ•°ï¼Œä¹Ÿå–å†³äºæœç´¢å¼•æ“æ˜¯å¦æ”¯æŒ
          label:
            en_US: time range
            ja_JP: time range
            pt_BR: time range
            zh_Hans: æ—¶é—´èŒƒå›´
          llm_description: ''
          max: null
          min: null
          name: time_range
          options:
          - label:
              en_US: In a day
              ja_JP: In a day
              pt_BR: In a day
              zh_Hans: ä¸€å¤©å†…
            value: day
          - label:
              en_US: In a week
              ja_JP: In a week
              pt_BR: In a week
              zh_Hans: ä¸€å‘¨å†…
            value: week
          - label:
              en_US: In a month
              ja_JP: In a month
              pt_BR: In a month
              zh_Hans: ä¸€ä¸ªæœˆå†…
            value: month
          - label:
              en_US: In a year
              ja_JP: In a year
              pt_BR: In a year
              zh_Hans: ä¸€å¹´å†…
            value: year
          placeholder: null
          precision: null
          required: false
          scope: null
          template: null
          type: select
        params:
          query: ''
          search_type: ''
          time_range: ''
        provider_id: langgenius/searxng/searxng
        provider_name: langgenius/searxng/searxng
        provider_type: builtin
        selected: false
        title: SearXNG å¤–éƒ¨Search
        tool_configurations:
          search_type: general
          time_range: null
        tool_description: SearXNG is a free internet metasearch engine which aggregates
          results from more than 70 search services.
        tool_label: SearXNG Search
        tool_name: searxng_search
        tool_parameters:
          query:
            type: mixed
            value: '{{#1747547366688.item#}}'
        type: tool
      height: 116
      id: '1747547417399'
      parentId: '1747547366688'
      position:
        x: 131.17333537276454
        y: 65
      positionAbsolute:
        x: 1364.1593262642896
        y: 486.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
      zIndex: 1002
    - data:
        code: "import json\nfrom typing import List, Dict, Any\nimport pprint # æ•´å½¢ã—ã¦è¡¨ç¤ºã™ã‚‹ãŸã‚ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆ\n\
          \n# loggingãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆã¨è¨­å®šã¯å‰Šé™¤ã—ã¾ã™\n\n# é–¢æ•°ã®å¼•æ•°ã®å‹ãƒ’ãƒ³ãƒˆã¯è¾æ›¸ã®ãƒªã‚¹ãƒˆã€æˆ»ã‚Šå€¤ã®å‹ãƒ’ãƒ³ãƒˆã¯ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°çµæœã€ã‚¨ãƒ©ãƒ¼ã€ãƒ‡ãƒãƒƒã‚°ãƒ­ã‚°ã‚’å«ã‚€è¾æ›¸ã«åˆã‚ã›ã¾ã™\n\
          def main(arg1: List[Dict[str, Any]]) -> Dict[str, Any]:\n    \"\"\"\n  \
          \  å…¥åŠ›ã•ã‚ŒãŸæ¤œç´¢çµæœã®ãƒªã‚¹ãƒˆã‹ã‚‰é–¢é€£æ€§ã®é«˜ã„çµæœã‚’ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã—ã€ã‚¨ãƒ©ãƒ¼æƒ…å ±ãŠã‚ˆã³ãƒ‡ãƒãƒƒã‚°ãƒ­ã‚°ã‚’å«ã‚ã¦è¿”å´ã—ã¾ã™ã€‚\n\n    Args:\n\
          \        arg1: å„æ¤œç´¢çµæœï¼ˆè¾æ›¸ï¼‰ã‚’å«ã‚€ãƒªã‚¹ãƒˆã€‚\n              å„æ¤œç´¢çµæœè¾æ›¸ã«ã¯ 'content' ã¨ 'score'\
          \ ç­‰ãŒå«ã¾ã‚Œã¾ã™ã€‚\n\n    Returns:\n        ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã•ã‚ŒãŸçµæœï¼ˆ'title', 'url', 'content',\
          \ 'score'ï¼‰\n        ã‚’å«ã‚€ãƒªã‚¹ãƒˆ ('filtered_results')ã€\n        å‡¦ç†ä¸­ã«ç™ºç”Ÿã—ãŸã‚¨ãƒ©ãƒ¼/è­¦å‘Šã®ãƒªã‚¹ãƒˆ\
          \ ('errors')ã€\n        ãŠã‚ˆã³ãƒ‡ãƒãƒƒã‚°ãƒ­ã‚°ã®ãƒªã‚¹ãƒˆ ('debug_log')\n        ã‚’å«ã‚€è¾æ›¸ã€‚\n   \
          \ \"\"\"\n    threshold = 0.5 # é–¢é€£æ€§ã®ã‚¹ã‚³ã‚¢ã®é–¾å€¤\n    filtered_results = []\n\
          \    error_messages = [] # ã‚¨ãƒ©ãƒ¼ã‚„è­¦å‘Šã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æ ¼ç´ã™ã‚‹ãƒªã‚¹ãƒˆ\n    debug_log = [] # ãƒ‡ãƒãƒƒã‚°ãƒ­ã‚°ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æ ¼ç´ã™ã‚‹ãƒªã‚¹ãƒˆ\n\
          \n    debug_log.append(\"--- Starting main function ---\")\n    debug_log.append(f\"\
          Threshold set to: {threshold}\")\n\n    # å…¥åŠ› arg1 ãŒãƒªã‚¹ãƒˆã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèª\n    if isinstance(arg1,\
          \ list):\n        results_list = arg1 # arg1 è‡ªä½“ãŒãƒªã‚¹ãƒˆã§ã™\n        debug_log.append(f\"\
          Input is a list with {len(results_list)} items.\")\n\n        # å–å¾—ã—ãŸãƒªã‚¹ãƒˆãŒç©ºã§ãªã„ã‹ã‚’ç¢ºèª\n\
          \        if not results_list:\n             debug_log.append(\"Info: Input\
          \ list is empty. No results to process.\")\n             # ãƒªã‚¹ãƒˆãŒç©ºã®å ´åˆã¯ã€filtered_results\
          \ ã‚‚ errors ã‚‚ debug_log ã‚‚ãã®ã¾ã¾è¿”ã•ã‚Œã¾ã™\n\n        # å–å¾—ã—ãŸãƒªã‚¹ãƒˆã®å„è¦ç´ ï¼ˆæ¤œç´¢çµæœã®è¾æ›¸ï¼‰ã‚’å‡¦ç†\n\
          \        for i, result in enumerate(results_list): # enumerateã‚’ä½¿ã£ã¦ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚‚å–å¾—\n\
          \            debug_log.append(f\"Processing item at index {i}\")\n     \
          \       # å„è¦ç´ ãŒè¾æ›¸ã§ã‚ã‚Šã€å¿…è¦ãªã‚­ãƒ¼ãŒå­˜åœ¨ã™ã‚‹ã‹ã‚’ç¢ºèª\n            # score, title, url, content\
          \ ã¯ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã¨å‡ºåŠ›ã«å¿…è¦ã¨ä»®å®š\n            required_keys = [\"score\", \"title\",\
          \ \"url\", \"content\"]\n            if isinstance(result, dict):\n    \
          \            debug_log.append(f\"Item {i} is a dictionary.\")\n        \
          \        if all(key in result for key in required_keys):\n             \
          \       debug_log.append(f\"Item {i} has all required keys.\")\n       \
          \             # score ã®å€¤ãŒæ•°å€¤å‹ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèª\n                    score_value =\
          \ result.get(\"score\")\n                    debug_log.append(f\"Item {i}:\
          \ Type of score: {type(score_value)}, Value: {score_value}\")\n\n      \
          \              if isinstance(score_value, (int, float)):\n             \
          \          debug_log.append(f\"Item {i}: Score is numeric.\")\n        \
          \               # ã‚¹ã‚³ã‚¢ãŒé–¾å€¤ä»¥ä¸Šã®ã‚‚ã®ã ã‘ã‚’ filtered_results ã«è¿½åŠ \n                \
          \       if score_value >= threshold:\n                           debug_log.append(f\"\
          Item {i}: Score {score_value} meets threshold {threshold}. Adding to results.\"\
          )\n                           filtered_result = {\n                    \
          \           \"title\": result.get(\"title\", \"N/A\"), # .get() ã‚’ä½¿ã†ã¨ã‚­ãƒ¼ãŒå­˜åœ¨ã—ãªã„å ´åˆã‚‚ã‚¨ãƒ©ãƒ¼ã«ãªã‚‰ãªã„\n\
          \                               \"url\": result.get(\"url\", \"N/A\"),\n\
          \                               \"content\": result.get(\"content\", \"\
          N/A\"),\n                               \"score\": score_value,\n      \
          \                     }\n                           filtered_results.append(filtered_result)\n\
          \                       else:\n                           # ã‚¹ã‚³ã‚¢ãŒé–¾å€¤æœªæº€ã®å ´åˆã¯ãƒ‡ãƒãƒƒã‚°ãƒ­ã‚°ã«è¨˜éŒ²\n\
          \                           debug_log.append(f\"Item {i}: Score {score_value}\
          \ below threshold {threshold}. Skipping.\")\n                    else:\n\
          \                        # ã‚¹ã‚³ã‚¢ãŒæ•°å€¤ã§ãªã„é …ç›®ã¯ã€ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¨ãƒ‡ãƒãƒƒã‚°ãƒ­ã‚°ã«è¿½åŠ ã—ã‚¹ã‚­ãƒƒãƒ—\n      \
          \                  msg = f\"Warning: Item at index {i} has non-numeric score:\
          \ {score_value}. Skipping item.\"\n                        error_messages.append(msg\
          \ + f\" Item details: {result}\") # errors ã«ã¯è©³ç´°ã‚‚å«ã‚ã‚‹\n                  \
          \      debug_log.append(msg) # debug_log ã«ã¯ç°¡æ½”ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸\n                  \
          \      debug_log.append(f\"Item {i}: Full item details: {result}\") # å¿…è¦ã«å¿œã˜ã¦è©³ç´°ã‚‚ãƒ­ã‚°ã«å«ã‚ã‚‹\n\
          \n                else:\n                     # å¿…è¦ãªã‚­ãƒ¼ãŒãªã„é …ç›®ã¯ã€ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¨ãƒ‡ãƒãƒƒã‚°ãƒ­ã‚°ã«è¿½åŠ ã—ã‚¹ã‚­ãƒƒãƒ—\n\
          \                     missing_keys = [key for key in required_keys if key\
          \ not in result]\n                     msg = f\"Warning: Item at index {i}\
          \ is missing required keys: {missing_keys}. Skipping item.\"\n         \
          \            error_messages.append(msg + f\" Item details: {result}\")\n\
          \                     debug_log.append(msg)\n                     debug_log.append(f\"\
          Item {i}: Full item details: {result}\")\n\n            else:\n        \
          \        # é …ç›®ãŒè¾æ›¸ã§ãªã„å ´åˆã€ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¨ãƒ‡ãƒãƒƒã‚°ãƒ­ã‚°ã«è¿½åŠ ã—ã‚¹ã‚­ãƒƒãƒ—\n                msg = f\"\
          Warning: Item at index {i} is not a dictionary. Item type: {type(result)}.\
          \ Skipping item.\"\n                error_messages.append(msg + f\" Item\
          \ details: {result}\")\n                debug_log.append(msg)\n        \
          \        debug_log.append(f\"Item at index {i}: Full item details: {result}\"\
          )\n\n    else:\n        # å…¥åŠ›ãŒãƒªã‚¹ãƒˆã§ãªã„å ´åˆã€ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¨ãƒ‡ãƒãƒƒã‚°ãƒ­ã‚°ã«è¿½åŠ \n        msg =\
          \ f\"Error: Input 'arg1' is not a list. Input type: {type(arg1)}. Cannot\
          \ process.\"\n        error_messages.append(msg)\n        debug_log.append(msg)\n\
          \n    debug_log.append(\"--- Finishing main function ---\")\n\n    # ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã•ã‚ŒãŸçµæœã€ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€ãŠã‚ˆã³ãƒ‡ãƒãƒƒã‚°ãƒ­ã‚°ã‚’å«ã‚€è¾æ›¸ã‚’è¿”å´\n\
          \    return {\n        \"filtered_results\": filtered_results,\n       \
          \ \"errors\": error_messages#,\n        #\"debug_log\": debug_log # ãƒ‡ãƒãƒƒã‚°ãƒ­ã‚°ãƒªã‚¹ãƒˆã‚’æˆ»ã‚Šå€¤ã«è¿½åŠ \n\
          \    }\n"
        code_language: python3
        desc: ''
        isInIteration: true
        isInLoop: false
        iteration_id: '1747547366688'
        outputs:
          errors:
            children: null
            type: array[object]
          filtered_results:
            children: null
            type: array[object]
        selected: false
        title: é–¾å€¤ã«ã‚ˆã‚‹æ¤œç´¢Scoreãƒ•ã‚£ãƒ«ã‚¿
        type: code
        variables:
        - value_selector:
          - '1747547417399'
          - json
          variable: arg1
      height: 54
      id: '1747547714864'
      parentId: '1747547366688'
      position:
        x: 461.12810025109684
        y: 65
      positionAbsolute:
        x: 1694.1140911426219
        y: 486.5
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
      zIndex: 1002
    - data:
        code: "import json\n\ndef main(arg1: str) -> dict:\n    parsed_output = json.loads(arg1)\n\
          \    return {\n        \"answer\": parsed_output[\"answer\"], \n       \
          \ \"references\": parsed_output.get(\"references\", []),\n    }\n\n"
        code_language: python3
        desc: ''
        outputs:
          answer:
            children: null
            type: string
          references:
            children: null
            type: array[object]
        selected: false
        title: ã¾ã¨ã‚ã¨å‚ç…§ã®æŠ½å‡º
        type: code
        variables:
        - value_selector:
          - '1747566414888'
          - text
          variable: arg1
      height: 54
      id: '1747558891643'
      position:
        x: 2381.894672437129
        y: 603.9145975570963
      positionAbsolute:
        x: 2381.894672437129
        y: 603.9145975570963
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ''
        selected: false
        template: '## å›ç­”


          {{answer}}


          ## å‚è€ƒæƒ…å ±


          {% if references %}

          {% for ref in references %}

          [{{loop.index}}] [{{ref.title}}]({{ref.url}})

          {% endfor %}

          {% else %}

          å‚è€ƒæ–‡çŒ®ã¯ã‚ã‚Šã¾ã›ã‚“

          {% endif %}'
        title: å›ç­”ä½œæˆ
        type: template-transform
        variables:
        - value_selector:
          - '1747558891643'
          - answer
          variable: answer
        - value_selector:
          - '1747558891643'
          - references
          variable: references
      height: 54
      id: '1747559305533'
      position:
        x: 2685.2638429290323
        y: 603.9145975570963
      positionAbsolute:
        x: 2685.2638429290323
        y: 603.9145975570963
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        answer: '{{#1747559305533.output#}}

          {{#1747658438705.files#}}'
        desc: ''
        selected: false
        title: å›ç­”å‡ºåŠ›
        type: answer
        variables: []
      height: 124
      id: '1747559467203'
      position:
        x: 2980.248690591287
        y: 603.9145975570963
      positionAbsolute:
        x: 2980.248690591287
        y: 603.9145975570963
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ''
        is_team_authorization: true
        output_schema: null
        paramSchemas:
        - auto_generate: null
          default: null
          form: llm
          human_description:
            en_US: Name of the database (input, inpit, or bigquery)
            ja_JP: Name of the database (input, inpit, or bigquery)
            pt_BR: Name of the database (input, inpit, or bigquery)
            zh_Hans: Name of the database (input, inpit, or bigquery)
          label:
            en_US: db_name
            ja_JP: db_name
            pt_BR: db_name
            zh_Hans: db_name
          llm_description: Name of the database (input, inpit, or bigquery)
          max: null
          min: null
          name: db_name
          options: []
          placeholder:
            en_US: Name of the database (input, inpit, or bigquery)
            ja_JP: Name of the database (input, inpit, or bigquery)
            pt_BR: Name of the database (input, inpit, or bigquery)
            zh_Hans: Name of the database (input, inpit, or bigquery)
          precision: null
          required: true
          scope: null
          template: null
          type: string
        - auto_generate: null
          default: null
          form: llm
          human_description:
            en_US: SQL query to execute on the database
            ja_JP: SQL query to execute on the database
            pt_BR: SQL query to execute on the database
            zh_Hans: SQL query to execute on the database
          label:
            en_US: query
            ja_JP: query
            pt_BR: query
            zh_Hans: query
          llm_description: SQL query to execute on the database
          max: null
          min: null
          name: query
          options: []
          placeholder:
            en_US: SQL query to execute on the database
            ja_JP: SQL query to execute on the database
            pt_BR: SQL query to execute on the database
            zh_Hans: SQL query to execute on the database
          precision: null
          required: true
          scope: null
          template: null
          type: string
        params:
          db_name: ''
          query: ''
        provider_id: 77fb5ee5-b977-4265-b978-cae66aee8e5f
        provider_name: DWH
        provider_type: api
        selected: false
        title: executeQuery
        tool_configurations: {}
        tool_description: Execute an SQL query on the specified database
        tool_label: executeQuery
        tool_name: executeQuery
        tool_parameters:
          db_name:
            type: mixed
            value: inpit
          query:
            type: mixed
            value: 'SELECT æŠ€è¡“åˆ†é‡1 AS ã‚»ã‚¯ã‚·ãƒ§ãƒ³, COUNT(*) AS å‡ºé¡˜æ•° FROM inpit_data WHERE å‡ºé¡˜äºº
              LIKE ''%{{#1747563309793.result#}}%'' GROUP BY æŠ€è¡“åˆ†é‡1 ORDER BY å‡ºé¡˜æ•° DESC;


              '
        type: tool
      height: 54
      id: '1747825209620'
      position:
        x: 1223.4659847732314
        y: 850.5122264340109
      positionAbsolute:
        x: 1223.4659847732314
        y: 850.5122264340109
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: ''
        memory:
          query_prompt_template: '{{#sys.query#}}'
          role_prefix:
            assistant: ''
            user: ''
          window:
            enabled: false
            size: 50
        model:
          completion_params:
            model_name: Claude 3.7 Sonnet
            temperature: 0.2
          mode: chat
          name: anthropic claude
          provider: langgenius/bedrock/bedrock
        prompt_template:
        - id: 3c46289e-0d8a-4657-babd-6d6a7c32bb1a
          role: system
          text: 'ã‚ãªãŸã®å½¹å‰²ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå…¥åŠ›ã—ãŸç›´å‰ã®ä¼šè©±å±¥æ­´ã‹ã‚‰ã€æœ€é©ãªç‰¹è¨±å‡ºé¡˜äººç›¸å½“ã®å›ºæœ‰åè©ã‚’æŠ½å‡ºã™ã‚‹ã“ã¨ã§ã™ã€‚


            ### ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³

            - å…¥åŠ›ãƒ†ã‚­ã‚¹ãƒˆã¨éå»ã®ä¼šè©±ã®æ–‡è„ˆã‚’è€ƒæ…®ã—ã¦ã€æœ€ã‚‚ãƒ¦ãƒ¼ã‚¶ã®å•ã„ã‹ã‘ã§é‡è¦ãªã‚‚ã®ã‚’ä¸€ã¤é¸ã‚“ã§ãã ã•ã„ã€‚


            ### å‡ºåŠ›å½¢å¼

            JSONå½¢å¼ã§å‡ºåŠ›:

            {"applicant_name":  æŠ½å‡ºã—ãŸå‡ºé¡˜äººå}'
        selected: false
        title: LLMã«ã‚ˆã‚‹å‡ºé¡˜äººåæŠ½å‡º
        type: llm
        variables: []
        vision:
          enabled: false
      height: 90
      id: '1747561605205'
      position:
        x: 662.032388469495
        y: 850.5122264340109
      positionAbsolute:
        x: 662.032388469495
        y: 850.5122264340109
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "\ndef main(arg1: str) -> dict:\n    return {\n        \"result\": json.loads(arg1)[\"\
          applicant_name\"],\n    }\n"
        code_language: python3
        desc: ''
        outputs:
          result:
            children: null
            type: string
        selected: false
        title: å‡ºé¡˜äººåæ–‡å­—åˆ—åŒ–
        type: code
        variables:
        - value_selector:
          - '1747561605205'
          - text
          variable: arg1
      height: 54
      id: '1747563309793'
      position:
        x: 931.6120763088563
        y: 850.5122264340109
      positionAbsolute:
        x: 931.6120763088563
        y: 850.5122264340109
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "\ndef main(arg1: str) -> dict:\n    parsed_output = json.loads(arg1)\n\
          \    return {\n        \"analyzed\": parsed_output[\"rows\"],\n    }\n"
        code_language: python3
        desc: ''
        outputs:
          analyzed:
            children: null
            type: array[object]
        selected: false
        title: æ¤œç´¢çµæœæŠ½å‡º
        type: code
        variables:
        - value_selector:
          - '1747825209620'
          - text
          variable: arg1
      height: 54
      id: '1747564264364'
      position:
        x: 1536.985990891525
        y: 850.5122264340109
      positionAbsolute:
        x: 1536.985990891525
        y: 850.5122264340109
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: ''
        model:
          completion_params: {}
          mode: chat
          name: anthropic claude
          provider: langgenius/bedrock/bedrock
        prompt_template:
        - id: d571ea5c-d811-4829-9b41-48323f799e23
          role: system
          text: 'ä»¥ä¸‹ã®åˆ†é¡åˆ¥å‡ºé¡˜æ•°ã¨æ¤œç´¢çµæœã¨PDFã®å†…å®¹ã‹ã‚‰ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è³ªå•ã«é–¢é€£ã™ã‚‹æƒ…å ±ã®ã¿ã‚’ä½¿ã£ã¦å›ç­”ã‚’ç”Ÿæˆã—ã¦ãã ã•ã„ã€‚

            ä½¿ç”¨ã—ãŸæƒ…å ±ã¯å¿…ãšå‚è€ƒæƒ…å ±ã¨ã—ã¦å‡ºåŠ›ã—ã¦ãã ã•ã„ã€‚

            ãƒ—ãƒ¬ãƒ¼ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã§å‡ºåŠ›ã—ã¦ä¸‹ã•ã„ã€‚


            ### æ¤œç´¢çµæœ

            {{#1747547366688.output#}}


            ### åˆ†é¡åˆ¥å‡ºé¡˜æ•°

            {{#1747568809800.output#}}


            ### PDF

            {{#1747658438705.files#}}'
        - id: beeef6ef-28c1-41ab-b208-300dd6445f67
          role: user
          text: "å›ç­”ã¯ã€ä¸‹è¨˜ã®JSONå½¢å¼ã§å‡ºåŠ›ã—ã¦ãã ã•ã„ã€‚\n{\n    \"answer\": \"ä½œæˆã—ãŸå›ç­”ã®å†…å®¹ã‚’ã“ã“ã«è¨˜è¼‰\",\n\
            \    \"references\": [\n        {\n            \"title\": \"ã‚¿ã‚¤ãƒˆãƒ«\",\n\
            \            \"url\": \"URL\"\n        }\n    ]\n}\n"
        selected: false
        title: LLMã«ã‚ˆã‚‹çµæœã®ã¾ã¨ã‚
        type: llm
        variables: []
        vision:
          configs:
            detail: high
            variable_selector:
            - '1747658438705'
            - files
          enabled: true
      height: 90
      id: '1747566414888'
      position:
        x: 2069.358629774583
        y: 603.9145975570963
      positionAbsolute:
        x: 2069.358629774583
        y: 603.9145975570963
      selected: true
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ''
        selected: false
        template: '| ã‚»ã‚¯ã‚·ãƒ§ãƒ³ | å‡ºé¡˜æ•° |

          |----------|--------|

          {% for item in analyzed %}

          | {{ item[''ã‚»ã‚¯ã‚·ãƒ§ãƒ³''] }} | {{ item[''å‡ºé¡˜æ•°''] }} |

          {% endfor %}'
        title: æŠ½å‡ºçµæœæ–‡ç« åŒ–
        type: template-transform
        variables:
        - value_selector:
          - '1747564264364'
          - analyzed
          variable: analyzed
      height: 54
      id: '1747568809800'
      position:
        x: 1818.7726432821732
        y: 850.5122264340109
      positionAbsolute:
        x: 1818.7726432821732
        y: 850.5122264340109
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        authorization:
          config: null
          type: no-auth
        body:
          data:
          - id: key-value-2950
            key: ''
            type: text
            value: "{\n    \"applicant_name\": \"{{#1747563309793.result#}}\",\n \
              \   \"start_year\": 2010,\n    \"end_year\": 2023\n  }"
          type: json
        desc: ''
        headers: Content-Type:application/json
        method: POST
        params: ''
        retry_config:
          max_retries: 3
          retry_enabled: true
          retry_interval: 100
        selected: false
        ssl_verify: true
        timeout:
          max_connect_timeout: 0
          max_read_timeout: 0
          max_write_timeout: 0
        title: HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆ
        type: http-request
        url: http://10.0.1.59:5006/analyze_pdf
        variables: []
      height: 110
      id: '1747658438705'
      position:
        x: 1223.4659847732314
        y: 943.5122264340109
      positionAbsolute:
        x: 1223.4659847732314
        y: 943.5122264340109
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: ''
        model:
          completion_params:
            temperature: 0.3
          mode: chat
          name: anthropic claude
          provider: langgenius/bedrock/bedrock
        prompt_template:
        - id: 4f8e3e62-2f55-4ef1-afad-3dd30d16e3b1
          role: system
          text: 'å›³ã¯ã‚°ãƒ©ãƒ•ã¨ã—ã¦èªè­˜ã—ã€ãƒ†ã‚­ã‚¹ãƒˆã®è¡¨ã«å¤‰æ›ã—ã¦ä¸‹ã•ã„ã€‚

            ãƒ†ã‚­ã‚¹ãƒˆã¯å³å¯†ã«å¤‰æ›ã—ã¦ä¸‹ã•ã„ã€‚'
        - id: 699342a6-571a-44f8-a507-a6cd7de18b47
          role: user
          text: 'PDFãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ã‚’ãƒ†ã‚­ã‚¹ãƒˆåŒ–ã—ã¦ä¸‹ã•ã„ã€‚

            {{#1747658438705.files#}}'
        selected: false
        title: LLM 4
        type: llm
        variables: []
        vision:
          configs:
            detail: high
            variable_selector:
            - '1747658438705'
            - files
          enabled: true
      height: 90
      id: '1747658612936'
      position:
        x: 1527.4659847732314
        y: 943.5122264340109
      positionAbsolute:
        x: 1527.4659847732314
        y: 943.5122264340109
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    viewport:
      x: -133.73720496838132
      y: 30.421904482945024
      zoom: 0.5219559637108769
