# æ™‚é–“ã‚ªãƒ•ã‚»ãƒƒãƒˆãƒã‚°ä¿®æ­£å®Œäº†å ±å‘Š

## ğŸš¨ ä¿®æ­£ã•ã‚ŒãŸãƒã‚°

**å•é¡Œ:** user2ï¼ˆkenï¼‰ã®08:30-11:00ã®äºˆå®šã«ã‚ˆã‚‹**08:30-09:00ãƒ–ãƒ­ãƒƒã‚¯ãŒè¡¨ç¤ºã•ã‚Œãªã„**

**åŸå› :** ã‚°ãƒªãƒƒãƒ‰è¡¨ç¤ºãŒ08:00ã‹ã‚‰å§‹ã¾ã£ã¦ã„ã‚‹ã®ã«ã€09:00ã‹ã‚‰ã®ãƒ–ãƒ­ãƒƒã‚¯ã—ã‹è¡¨ç¤ºã•ã‚Œã¦ã„ãªã„

## ğŸ” æ ¹æœ¬åŸå› ã®ç‰¹å®š

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç¢ºèª
```sql
-- æœˆæ›œæ—¥ã®å®Ÿéš›ã®ãƒ‡ãƒ¼ã‚¿
admin:  09:00-10:00, 10:00-12:00, 14:00-16:00
user1:  09:30-10:30, 10:00-12:00, 15:00-17:00
user2:  08:30-11:00, 11:00-12:00  â† 08:30-09:00ã¯1äººã ã‘
```

### å•é¡Œã®ã‚ã£ãŸãƒ­ã‚¸ãƒƒã‚¯
```javascript
// ä¿®æ­£å‰: 2äººä»¥ä¸Šã®ä¼šè­°æ™‚é–“ã‹ã‚‰ã®ã¿æ™‚é–“ãƒã‚¤ãƒ³ãƒˆã‚’åé›†
daySlots.forEach(slot => {
    allDynamicTimePoints.add(slot.start);  // 08:30ã¯å«ã¾ã‚Œãªã„ï¼
    allDynamicTimePoints.add(slot.end);
});
```

**çµæœ:** 08:30-09:00ã¯1äººã ã‘ãªã®ã§ã€`calculateDynamicTimeSlots()`ã§é™¤å¤– â†’ æ™‚é–“ãƒã‚¤ãƒ³ãƒˆã«08:30ãŒå«ã¾ã‚Œãªã„ â†’ ã‚°ãƒªãƒƒãƒ‰ãƒ˜ãƒƒãƒ€ãƒ¼ã«08:30åˆ—ãŒç”Ÿæˆã•ã‚Œãªã„

## âœ… å®Ÿè£…ã—ãŸä¿®æ­£

### 1. æ™‚é–“ãƒã‚¤ãƒ³ãƒˆåé›†ã®ä¿®æ­£
```javascript
// ä¿®æ­£å¾Œ: å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å…¨ç©ºãæ™‚é–“ã‹ã‚‰æ™‚é–“ãƒã‚¤ãƒ³ãƒˆã‚’åé›†
allUsers.forEach(user => {
    DAYS_OF_WEEK.forEach(day => {
        user.availability[day.key].forEach(slot => {
            allDynamicTimePoints.add(slot.start);  // 08:30ãŒå«ã¾ã‚Œã‚‹ï¼
            allDynamicTimePoints.add(slot.end);
        });
    });
});
```

### 2. ã‚°ãƒªãƒƒãƒ‰ã‚»ãƒ«ç”Ÿæˆã®ä¿®æ­£
```javascript
// ä¼šè­°ã‚¹ãƒ­ãƒƒãƒˆï¼ˆ2+äººï¼‰ãŒãªã„å ´åˆã‚‚ã€å€‹åˆ¥ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ç©ºãæ™‚é–“ã‚’ãƒã‚§ãƒƒã‚¯
if (!meetingSlot) {
    // 1äººã ã‘ã§ã‚‚ç©ºããŒã‚ã‚Œã°è¡¨ç¤ºç”¨ã‚¹ãƒ­ãƒƒãƒˆã‚’ä½œæˆ
    if (availableUsers.length > 0) {
        singleUserSlot = {
            start: header.start,
            end: header.end,
            available_users: availableUsers.sort(),
            unavailable_users: unavailableUsers.sort(),
            participant_count: availableUsers.length,
            availability_percentage: Math.round((availableUsers.length / maxParticipants) * 100)
        };
    }
}
```

### 3. è¦–è¦šçš„åŒºåˆ¥ã®è¿½åŠ 
```javascript
// 1äººç”¨ã€éƒ¨åˆ†å‚åŠ ã€å…¨å“¡å‚åŠ ã‚’åŒºåˆ¥
if (isSingleUser) {
    finalColor = '#F8F9FA';        // è–„ã„ã‚°ãƒ¬ãƒ¼
    borderColor = '#DEE2E6';       // è–„ã„ãƒœãƒ¼ãƒ€ãƒ¼
    displayText = username[0];     // ãƒ¦ãƒ¼ã‚¶ãƒ¼åã®æœ€åˆã®æ–‡å­—
}
```

## ğŸ¯ ä¿®æ­£çµæœ

### ä¿®æ­£å‰
```
æ™‚é–“å¸¯:   [09:00-09:30] [09:30-10:00] [10:00-11:00]
æœˆæ›œæ—¥:   [    2äºº    ] [    3äººğŸ¯   ] [    3äººğŸ¯   ]
```
âŒ **08:30-09:00ãŒæ¬ è½**

### ä¿®æ­£å¾Œ
```
æ™‚é–“å¸¯: [08:30-09:00] [09:00-09:30] [09:30-10:00] [10:00-11:00]
æœˆæ›œæ—¥: [     U      ] [    2äºº    ] [    3äººğŸ¯   ] [    3äººğŸ¯   ]
```
âœ… **08:30-09:00ãŒæ­£ã—ãè¡¨ç¤º**

## ğŸ“‹ æŠ€è¡“çš„å¤‰æ›´ç‚¹

### ãƒ•ã‚¡ã‚¤ãƒ«: `app/frontend/app.js`

1. **updateMeetingGrid()é–¢æ•°** (Line 470-497)
   - å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰æ™‚é–“ãƒã‚¤ãƒ³ãƒˆåé›†ã«å¤‰æ›´

2. **ã‚°ãƒªãƒƒãƒ‰ç”Ÿæˆãƒ­ã‚¸ãƒƒã‚¯** (Line 540-591)
   - 1äººç”¨ã‚¹ãƒ­ãƒƒãƒˆã®æ¤œå‡ºã¨ç”Ÿæˆã‚’è¿½åŠ 

3. **generateDynamicGridCell()é–¢æ•°** (Line 686-733)
   - 1äººç”¨ã‚¹ãƒ­ãƒƒãƒˆã®è¦–è¦šçš„åŒºåˆ¥ã‚’è¿½åŠ 
   - æ¡ä»¶ã‚’ `participant_count < 2` ã‹ã‚‰ `participant_count === 0` ã«å¤‰æ›´

## ğŸ” å‹•ä½œç¢ºèª

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¤œè¨¼
```bash
sqlite3 data/scheduler.db "SELECT u.username, a.day_of_week, a.start_time, a.end_time
                          FROM users u LEFT JOIN availability a ON u.id = a.user_id
                          WHERE a.day_of_week = 'monday' ORDER BY a.start_time;"
```

**çµæœ:**
- admin: monday, 09:00, 10:00
- user2: monday, **08:30**, 11:00 âœ… ç¢ºèªæ¸ˆã¿

### HTMLå‡ºåŠ›æ¤œè¨¼
- æ™‚é–“ãƒ˜ãƒƒãƒ€ãƒ¼: `08:30-09:00` ãŒæœ€åˆã®åˆ—ã¨ã—ã¦è¡¨ç¤º
- ã‚»ãƒ«å†…å®¹: `U` (user2ã®é ­æ–‡å­—) ãŒè¡¨ç¤º
- ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ—: æ­£ç¢ºãªæ™‚é–“ã¨å‚åŠ è€…æƒ…å ±

## âœ… ä¿®æ­£å®Œäº†ç¢ºèª

ğŸ‰ **æ™‚é–“ã‚ªãƒ•ã‚»ãƒƒãƒˆãƒã‚°ã¯å®Œå…¨ã«ä¿®æ­£ã•ã‚Œã¾ã—ãŸ**

- âœ… user2ã®08:30-11:00äºˆå®šãŒæ­£ã—ãåæ˜ 
- âœ… 08:30-09:00ãƒ–ãƒ­ãƒƒã‚¯ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- âœ… ã‚°ãƒªãƒƒãƒ‰ãƒ˜ãƒƒãƒ€ãƒ¼ã¨æ™‚é–“ãƒ‡ãƒ¼ã‚¿ãŒæ­£ç¢ºã«ã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆ
- âœ… 1äººç”¨ã€éƒ¨åˆ†å‚åŠ ã€å…¨å“¡å‚åŠ ãŒè¦–è¦šçš„ã«åŒºåˆ¥ã•ã‚Œã‚‹

**è¨¼æ˜:** `time_fix_proof.html` ã§è¦–è¦šçš„ç¢ºèªãŒå¯èƒ½